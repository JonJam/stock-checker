# Based off: https://github.com/actions/starter-workflows/blob/main/ci/go.yml
name: Go

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:

  build:
    name: Build
    runs-on: ubuntu-latest
    steps:

    - name: Setup Go Environment
      uses: actions/setup-go@v2
      with:
        go-version: '^1.15.5'

    - name: Checkout code
      uses: actions/checkout@v2

    - name: Get dependencies
      run: |
        go get -v -t -d ./...
        if [ -f Gopkg.toml ]; then
            curl https://raw.githubusercontent.com/golang/dep/master/install.sh | sh
            dep ensure
        fi

    - name: Build
      run: go build -v ./...

    - name: Test
      run: go test -v ./...

  # # Set the job key. The key is displayed as the job name
  # # when a job name is not provided
  # super-lint:
  #   # Name the Job
  #   name: Lint code base
  #   # Set the type of machine to run on
  #   runs-on: ubuntu-latest

  #   steps:
  #     # Checks out a copy of your repository on the ubuntu-latest machine
  #     - name: Checkout code
  #       uses: actions/checkout@v2

  #     # Runs the Super-Linter action
  #     - name: Run Super-Linter
  #       uses: github/super-linter@v3
  #       env:
  #         DEFAULT_BRANCH: main
  #         GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}